# QGroundControlを使ってドローンを最短でセットアップしたい人向けのマニュアル

## はじめに

躓いたときはQGCのリファレンスページを参照しましょう. 
ユーザーガイドかデベロッパーガイドを見れば大抵のことは解決するはず(?)
[PX4 User Guide](https://docs.px4.io/en/)
[PX4 Development Guide](https://dev.px4.io/en/)

- 注意点
  - QGCはオープンソースプロジェクトなのでバージョンが更新されていきます. 利用しているファームウェアバージョンと同じバージョンのリファレンスを参照しましょう.(現 stable -v1.8.2)
  - 想定外のエラーに遭遇した際はリファレンスを見ても解決しない場合が多いので, 検索エンジンの利用を推奨します. 


## フライトログ取得までのフローチャート

フローチャートの手順で進めるとスムーズ

<div align="center">
<img src="./images/QGC01.png" alt="属性" title="タイトル">
</div>

![](./images/QGC01.png)



### ドローンパーツの選定
ドローン製作にあたって必要なパーツは以下の通り.

- フライトコントローラー
  - Pixhawk2.4.x
- GPS モジュール
- Switch　モジュール
- Buzzer モジュール
- Power モジュール
- telemetly モジュール
  - 必須ではないが, あると便利.
  - USB接続せずPCから遠隔で設定, フライトが可能になる. 

- 機体フレーム
- モータ用アンプ
- ブラシレスモーター
- プロペラ
- 電池
  - LiPo
- 受信機
  - プロポと信号の送受信をするモジュール
  - PWM信号([参考](http://www.kairo-nyumon.com/pwm_signal.html))
- PPM Encoder
- プロポ

### QGroundControlのインストール

公式サイトからダウンロードしてインストール. 
[qgroudcontrol.com](http://qgroundcontrol.com/)

### 組み立て

省略


### QGCでフライトコントローラのセットアップ

- ファームウェアの選択
  - PixhawkをPCに接続し, `PX4 Flight Stack v1.8.2 Stable Release`を選択
  - ファームウェアを選択すると, 各項目が赤く変化
  - 赤い項目をクリアしていくことでアームが可能に


##### Airframe

利用したいAirframeを選択し, `Apply and Restart`を押下


##### Sensor
センサごとに押下し, 指示に従いキャリブレーションを実行する

##### Radio
受信機からプロポの信号が入力されている場合, Channel Monitorのポインターが動作する. 入力を確認後, Modelを選択し, 指示に従いプロポのキャリブレーションを行う.

###### キャリブレーション(補足)

      キャリブレーション（較正, 校正）は, 計器を基準に整合するよう調整する工程です. 
      通常キャリブレーションをしていない状態でのフライトはできません.

      QGroundControlでは, 
      - Compass
      - Gyroscope
      - Accelerometer
      - Level Horizon
      - (Airspeed)

      のセンサーキャリブレーションと, ラジオ(プロポ)のキャリブレーションが必要になります.
      (Airspeedは対気速度が必要になるAirframeを選択するとピトー管の取り付けと, キャリブレーションが必要になります.)
      また, ブラシレスモータの制御を行うESC(アンプ)のキャリブレーションも必要になります.

##### Flight Modes
- フライトモードとアームのスイッチをchannelに割り当てる必要がある. 
- 基本的に, プロポの操舵を行うスティック以外のチャンネルに割りあてる. 
- 遷移飛行を行うAirframeでは, トランジションスイッチも割り当てる必要がある.

##### Power
- アームにあたって, バッテリの設定は不要.
- `ESC PWM Minimum and Maximum Calibration`の項目で, ESCのキャリブレーションをまとめて行うことができる（簡単なのでおすすめ） 
- ※ESCごとにキャリブレーションを行うこともできる(ESCの説明書に記述)

### フライト
作ったドローンをフライトさせるためには, いくつかの準備が必要です.
- アーム
- バッテリ残量の確認
- 周囲の状況確認
  - 風速
  - 天候
  - 人

##### アーム
- Switchモジュールを長押し後, アームスイッチを入れることでアームできます.
- アームするとスロットルへの入力が入るようになります.

**Let's flight.**


### フライトログの取得
QGroundControlは, 独自の分析ビューを開発しています[[Flight Review](https://review.px4.io/)]. Pixhawkでは, microSDを挿入しておくだけでフライトログが取得できます. 取得したフライトログ(拡張子:ulg)データをFlightReviewにアップロードすることでログの分析が可能です.(ulgファイルはcsvに変換可能なのでエクセルでグラフ化することもできます)


# Appendix（予定）

- 躓いたエラーたち
- ハード的な問題?
- プロポの設定について